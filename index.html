<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <div class="root">
      <button class="zoom-button">toggle zoom</button>
      <div class="image-selector"></div>
      <div class="image-container">
        <img src="./imgs/61 - tOFX0K7.jpg" alt="" class="" />
        <div class="mark hidden"></div>
      </div>
    </div>
  </body>
  <script>
    const images = [
      "Amusement park ( with tatordolls) by me. u_trippeltorch tw9huwjt02id1.jpeg",
      "Barton Springs by Regone Studios  David Regone 1vddkpdqn52f1.jpeg",
      "S.P.A.C.E. CON 2225 Intergalactic convention poster OC By Chekavo - Egor Klyuchnyk 98owz53645of1.jpeg",
      "Time Keepers by Alexander HuÃ©rfano asqshvcuz9qf1.png",
      "Universe 113 Infested poster. Remake of my very first isometric illustration [OC] Egor Klyuchnyk Chekavo 7g5asc3718wc1.jpeg",
      "Willy Wonka & The Chocolate Factory by me! (Morgan Girvin) fstxnkvf2kge1.jpeg",
    ];

    const phone_position = {
      top: 0.55794234030525720746184284906727,
      left: 0.44808126410835214446952595936795,
      bottom: 0.62690785754663651780667043527417,
      right: 0.46764484574868322046651617757713,
    };

    const imgtag = document.querySelector("img");
    const imageContainer = document.querySelector(".image-container");
    const mark = document.querySelector(".mark");
    const zoomButton = document.querySelector(".zoom-button");
    let zoomed = false;
    const imageSelector = document.querySelector(".image-selector");
    let scaleFactor = 0.5;

    function setImage(imageName) {
      imgtag.src = "./imgs/" + imageName;
    }

    function handleImageButtonClick(event) {
      const imageName = event.target.dataset.imageName;
      setImage(imageName);
    }

    images.forEach((image, index) => {
      const button = document.createElement("button");
      button.textContent = index;
      button.dataset.imageName = image;
      button.addEventListener("click", handleImageButtonClick);
      imageSelector.appendChild(button);
    });

    imageContainer.addEventListener("click", (event) => {
      const target = event.target;
      // convert mouse position relative to the picture's dimensions
      // to a value in a scale between 0 and 1
      const normalizedPos = {
        x: event.offsetX / imgtag.clientWidth,
        y: event.offsetY / imgtag.clientHeight,
      };

      const isPhone =
        phone_position.left < normalizedPos.x &&
        normalizedPos.x < phone_position.right &&
        phone_position.top < normalizedPos.y &&
        normalizedPos.y < phone_position.bottom;

      console.log({ isPhone });

      markSize = imgtag.offsetWidth * 0.02;
      mark.style.width = markSize + "px";
      mark.style.height = markSize + "px";
      mark.style.left = event.offsetX - markSize / 2 + "px";
      mark.style.top = event.offsetY - markSize / 2 + "px";
      mark.classList.remove("hidden");
    });

    imageContainer.addEventListener("mousemove", (event) => {
      const target = event.target;

      imageContainerSize = imageContainer.getBoundingClientRect();

      const fixedCoords = {
        x: event.clientX - imageContainerSize.left,
        y: event.clientY - imageContainerSize.top,
      };

      const realtivePos = {
        x: fixedCoords.x / imageContainer.clientWidth,
        y: fixedCoords.y / imageContainer.clientHeight,
      };

      imageContainer.scroll(
        imgtag.offsetWidth * realtivePos.x - imageContainer.clientWidth / 2,
        imgtag.offsetHeight * realtivePos.y - imageContainer.clientHeight / 2
      );
    });

    zoomButton.addEventListener("click", (event) => {
      scaleFactor = Math.min(1, scaleFactor + 0.1);

      const naturalWidth = imgtag.naturalWidth;
      const naturalHeight = imgtag.naturalHeight;

      imgtag.style.width = naturalWidth * scaleFactor + "px";
      imgtag.style.height = naturalHeight * scaleFactor + "px";

      mark.classList.add("hidden");
    });

    function scaleIn() {
      scaleFactor = Math.min(scaleFactor + 0.1, 1);
      updateZoom();
    }

    function scaleOut() {
      scaleFactor = Math.max(
        scaleFactor - 0.1,
        imageContainer.clientWidth / imgtag.naturalWidth
      );
      updateZoom();
    }

    function updateZoom() {
      const naturalWidth = imgtag.naturalWidth;
      const naturalHeight = imgtag.naturalHeight;

      imgtag.style.width = naturalWidth * scaleFactor + "px";
      imgtag.style.height = naturalHeight * scaleFactor + "px";

      mark.classList.add("hidden");
    }

    imageContainer.addEventListener("wheel", (event) => {
      if (event.deltaY < 0) {
        scaleIn();
      } else {
        scaleOut();
      }
    });
  </script>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .root {
      max-width: 90vw;
    }

    .hidden {
      display: none;
    }

    .image-container {
      position: relative;
      width: 100%;
      max-height: 90vh;
      border: 2px solid red;
      overflow: auto;
    }

    .mark {
      position: absolute;
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      border: 1px solid lime;
      box-shadow: 0 0 10px lime, 0 0 10px lime inset;
      bottom: 1rem;
      pointer-events: none;
      animation-name: breath;
      animation-duration: 2s;
      animation-timing-function: ease-in-out;
      animation-iteration-count: infinite;
    }

    @keyframes breath {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.5);
      }
      100% {
        transform: scale(1);
      }
    }

    .image-container img {
      width: inherit;
      height: inherit;
      object-fit: cover;
      display: block;
    }

    .image-container img.zoomed {
      width: unset;
      height: unset;
    }
  </style>
</html>
